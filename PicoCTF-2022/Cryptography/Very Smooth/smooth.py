import math

n = 16237273966836108120545793138084928629897229433359269853811036517408130990412315905032719835933027062806349026656969546706952216885700336241987462198846497866128469385845087257177806462075448795745255645036851304171294558034005843928223969132994878078039177397552489432477344386147809047379385391476398181005238431374419231170133622553608140144429529176425884181430778587305916041812649403278600142298567709101416482483848715249963954872862606729158862177500165861249872096563311618578664620929914771757453426377719542453172601160223030029072465102848163437163175061493978855848151566051932864722199692067969595188193
c = 14745518102990549993396231967010238598925487595737075102386714453833205999128514312343709574624206318784861363720687177363005855875685151439468735846849178516191250958513321418226126816220441622072775955158815313589415768991800850191022965127365179938485201605989512584224856864097157025326152644518178208895823099852290816783590694778428942262388258380986236466393936876338985762104185300723246403101722728880398442822038831738505696484763293920759869961241173735321794418273452100930321283190648733233608152140950572032537233345544765845396824420445758020322122287448862461166508152964791654530816373179266420063082
e = 65537

a = 2
big_b = int(input("B: "))

noprimes = set(j for i in range(2, round(math.sqrt(big_b)+1)) for j in range(i*2, big_b, i))
primes = [x for x in range(2, big_b+1) if x not in noprimes]

big_m = 1

for i in primes:
    j = i ** math.floor(math.log(big_b, i))
    big_m *= j

print(big_m)

p = math.gcd(pow(a, big_m - 1, n), n)

q = n // p
carmichael = math.lcm(int(p - 1), int(q - 1))

e = 65537
d = pow(e, -1, carmichael)
print(f"d: {d}")

flag = pow(int(c), d, int(n))
print(f"flag: {flag}")
print(f"flag hex: {hex(int(flag))}")
